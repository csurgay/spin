<!DOCTYPE html>
<html>
    <head>
        <title>Spin</title>
    </head>
    <body onload="init();" style="margin:0;overflow:hidden;">
        <canvas id="mycanvas"></canvas>
        <script>
const r=300;
const canvas=document.getElementById("mycanvas");
canvas.width = window.innerWidth;
canvas.height = window.innerHeight;
const ctx=canvas.getContext("2d");
const wheel=new Image();
function init() {
    console.log("Start...");
    wheel.onload=main;
    wheel.src="spin.jpg";
}
function main() {
    console.log("Loaded...");
    ctx.translate(r,r);
    ctx.beginPath();
    ctx.arc(0,0,r,0,2*Math.PI);
    ctx.clip();
    ctx.drawImage(wheel,-r,-r,2*r,2*r);
    animate();
}
var alpha=1;
var step=0;
var limit=0;
var state="stage0";
function animate() {
    ctx.rotate(2*Math.PI/alpha);
    ctx.drawImage(wheel,-r,-r,2*r,2*r);
    step++;
    if (state=="stage0") {
        if (step>limit) {
            limit+=100+100*Math.random();
            state="stage1";
        }
    }
    else if (state=="stage1") {
        alpha++;
        if (step>limit) {
            limit+=100+100*Math.random();
            state="stage2";
        }
    }
    else if (state=="stage2") {
        alpha*=1.03;
        if (step>limit) {
            limit+=100+100*Math.random();
            state="stage3";
        }
    }
    else if (state=="stage3") {
        alpha*=10;
        if (step>limit) {
            limit+=50+50*Math.random();
            state="stage4";
        }
    }
    if (state!="stage4") window.requestAnimationFrame(animate);
}
        </script>
    </body>
</html>
